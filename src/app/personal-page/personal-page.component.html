<div class="row">
  <div class="col-6 col-12-narrower">
    <section id="parametri" class="box">
      <div *ngIf="userInfoError.isEmpty && user.isDefined">
        <h2>I tuoi dati personali</h2>
        <ul>
          <li><b>Codice Fiscale: </b> {{user.get.codicefiscale}}</li>
          <li><b>Nome: </b> {{user.get.nome}}</li>
          <li><b>Cognome: </b> {{user.get.cognome}}</li>
          <li><b>e-mail: </b> {{user.get.email}}</li>
        </ul>
      </div>
      <div *ngIf="userInfoError.isDefined">
        <ul>{{userInfoError.get}}</ul>
      </div>
    </section>
  </div>
  <div class="col-6 col-12-narrower">
    <section *ngIf="userInfoError.isEmpty && user.isDefined && request.isDefined" id="richiesta" class="box">
      <div>
        <h2>La tua ultima richiesta di assistenza</h2>
        <ul class="no_margin">
          <li><b>ID richiesta: </b> {{request.get.id}}</li>
          <li><b>Data richiesta: </b> {{request.get.requestDate.toLocaleString([], {day: "2-digit", month: "long", year: "numeric", hour: "2-digit", minute: "2-digit", second: "2-digit"})}}</li>
        </ul>
        <!--instanceof is not available in templates, so we check for the existence of a field only present in DrunkDriving-->
        <ul *ngIf="drunkDriving.isDefined">
          <li><b>Tipo richiesta: </b>Guida in stato di ebbrezza</li>
          <li><b>Rilevazione tasso alcolemico: </b> {{drunkDriving.get.tasso}} grammi/litro</li>
          <li><b>Recidiva: </b> {{drunkDriving.get.recidiva === true ? 'sì' : 'no'}}</li>
          <li><b>Rifiuto accertamento: </b> {{drunkDriving.get.rifiutato === true ? 'sì' : 'no'}}</li>
          <li><b>Veicolo appartenente a estraneo: </b> {{drunkDriving.get.estraneo === true ? 'sì' : 'no'}}</li>
          <li><b>Incidente: </b> {{drunkDriving.get.incidente === true ? 'sì' : 'no'}}</li>
        </ul>
        <hr>
        <div class="form-group">
          <h4>Documentazione relativa alla richiesta di assistenza</h4>
          <h5>File inviati</h5>
          <div ng-ts-spinner [spinOn]="communicatingFiles" [options]="{scale: 0.2}" class="spinnerDiv">
            <div class="insideSpinner">
              <ng-container *ngIf="filesListError.isEmpty">
                <ul>
                  <ng-container *ngIf="alreadyUploadedFiles.length > 0">
                    <li *ngFor="let file of alreadyUploadedFiles">{{file}}</li>
                  </ng-container>
                  <ng-container *ngIf="alreadyUploadedFiles.length === 0">
                    <li>[Nessun file caricato]</li>
                  </ng-container>
                </ul>
              </ng-container>
              <ng-container *ngIf="filesListError.isDefined">
                <p>{{filesListError.get}}</p>
              </ng-container>
            </div>
          </div>
          <h5>Invio nuovi file</h5>
          <input type="file" id="fileInput" (change)="handleFileInput(fileInput.files)" style="display: none" #fileInput>
          <button *ngIf="!fileToUpload.isDefined" class="button special" (click)="fileInput.click()">Seleziona file</button>
          <button *ngIf="fileToUpload.isDefined" class="button special" (click)="uploadFile()">Invia file</button>
          <p class="no_margin" style="font-size: small">Sono consentiti i seguenti formati: jpeg, png, tiff e pdf</p>
          <p *ngIf="fileUploadStatus.length > 0">{{fileUploadStatus}}</p>
        </div>
      </div>
      <hr>
    </section>
    <section *ngIf="userInfoError.isEmpty && user.isDefined && !request.isDefined" id="emptyReq" class="box">
      <div>
        <h2>Non sono presenti richieste di assistenza</h2>
      </div>
    </section>
  </div>
</div>
